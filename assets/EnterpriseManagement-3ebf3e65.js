import{_ as Fe,Q as De,V as Se,r as u,f as W,K as J,k as xe,g as p,o as y,c as D,a as v,h as l,i as t,N as S,E,P as X,F as M,q as K,j as s,t as c,p as F,n as Ne,U as R}from"./index-45cd1a9a.js";const Te={name:"EnterpriseManagement",components:{Plus:De,Download:Se},setup(){const H=u("enterprise"),a=u(""),B=u(""),r=u(""),L=u(1),O=u(10),x=u(""),q=u(""),g=u(""),f=u(1),h=u(10),N=u(!1),T=u(!1),d=u(!1),z=u(!1),i=u(!1),k=u(!1),U=u([]),_=u([]),Z=u([]),A=u(null),w=u(null),j=[{label:"科技",value:"technology"},{label:"金融",value:"finance"},{label:"制造",value:"manufacturing"},{label:"教育",value:"education"},{label:"医疗",value:"medical"},{label:"零售",value:"retail"},{label:"其他",value:"other"}],C=W({name:"",industry:"",contactPerson:"",contactPhone:"",email:"",address:"",energyQuota:1e4,occupiedZones:[],remark:""}),m={name:[{required:!0,message:"请输入企业名称",trigger:"blur"}],industry:[{required:!0,message:"请选择所属行业",trigger:"change"}],contactPerson:[{required:!0,message:"请输入联系人姓名",trigger:"blur"}],contactPhone:[{required:!0,message:"请输入联系电话",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号码",trigger:"blur"}],email:[{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],address:[{required:!0,message:"请输入企业地址",trigger:"blur"}],energyQuota:[{required:!0,message:"请输入能耗配额",trigger:"blur"},{type:"number",min:0,message:"能耗配额必须为非负数",trigger:"blur"}]},P=W({username:"",password:"",confirmPassword:"",realName:"",role:"user",enterpriseId:"",email:"",phone:""}),Q={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],confirmPassword:[{required:!0,message:"请再次输入密码",trigger:"blur"},{validator:(o,n,b)=>{n!==P.password?b(new Error("两次输入的密码不一致")):b()},trigger:"blur"}],realName:[{required:!0,message:"请输入真实姓名",trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"change"}],enterpriseId:[{required:()=>P.role!=="admin",message:"请选择所属企业",trigger:"change"}],email:[{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号码",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号码",trigger:"blur"}]},e=W({newPassword:"",confirmNewPassword:""}),V={newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"}],confirmNewPassword:[{required:!0,message:"请再次输入新密码",trigger:"blur"},{validator:(o,n,b)=>{n!==e.newPassword?b(new Error("两次输入的密码不一致")):b()},trigger:"blur"}]},$=J(()=>U.value.filter(o=>{const n=!a.value||o.name.toLowerCase().includes(a.value.toLowerCase())||o.contactPerson.toLowerCase().includes(a.value.toLowerCase()),b=!B.value||o.status===B.value,I=!r.value||o.industry===r.value;return n&&b&&I})),ee=J(()=>_.value.filter(o=>{const n=!x.value||o.username.toLowerCase().includes(x.value.toLowerCase())||o.realName.toLowerCase().includes(x.value.toLowerCase()),b=!q.value||o.role===q.value,I=!g.value||o.status===g.value;return n&&b&&I})),re=o=>{const n=j.find(b=>b.value===o);return n?n.label:o},le=o=>({admin:"管理员",enterprise_admin:"企业负责人",maintenance:"运维人员",user:"普通用户"})[o]||o,ae=o=>({admin:"danger",enterprise_admin:"success",maintenance:"warning",user:"info"})[o]||"info",te=o=>{const n=U.value.find(b=>b.id===o);return n?n.name:null},oe=o=>!o||o.length===0?"--":o.map(n=>{var b;return((b=Z.value.find(I=>I.id===n))==null?void 0:b.name)||""}).filter(n=>n).join(", "),Y=o=>{if(!o)return"--";const n=new Date(o);return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}-${String(n.getDate()).padStart(2,"0")}`},ne=o=>{if(!o)return"--";const n=new Date(o);return`${Y(o)} ${String(n.getHours()).padStart(2,"0")}:${String(n.getMinutes()).padStart(2,"0")}`},se=o=>{A.value={...o}},ie=o=>{w.value={...o}},de=o=>{A.value={...o},T.value=!0},ue=()=>{Object.assign(C,{name:"",industry:"",contactPerson:"",contactPhone:"",email:"",address:"",energyQuota:1e4,occupiedZones:[],remark:""}),d.value=!1,N.value=!0},me=o=>{Object.assign(C,{...o}),d.value=!0,N.value=!0},pe=()=>{if(d.value){const o=U.value.findIndex(n=>n.id===C.id);o!==-1&&(U.value[o]={...U.value[o],...C},E.success("企业更新成功"))}else{const o={...C,id:`ENT-${Date.now()}`,status:"normal",registeredDate:new Date().toISOString(),monthEnergyUsage:0};U.value.push(o),E.success("企业新增成功")}N.value=!1},ce=o=>{const n=o.status==="normal"?"disabled":"normal";X.confirm(`确定要${n==="normal"?"启用":"禁用"}企业「${o.name}」吗？`,"确认操作",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{o.status=n,E.success(`企业${n==="normal"?"启用":"禁用"}成功`)}).catch(()=>{})},ge=()=>{E.success("企业数据导出成功")},fe=()=>{Object.assign(P,{username:"",password:"",confirmPassword:"",realName:"",role:"user",enterpriseId:"",email:"",phone:""}),i.value=!1,z.value=!0},G=o=>{Object.assign(P,{...o}),i.value=!0,z.value=!0},we=()=>{if(i.value){const o=_.value.findIndex(n=>n.id===P.id);if(o!==-1){const{password:n,confirmPassword:b,...I}=P;_.value[o]={..._.value[o],...I},E.success("用户更新成功")}}else{const o={...P,id:`USR-${Date.now()}`,status:"active",createdAt:new Date().toISOString()};_.value.push(o),E.success("用户新增成功")}z.value=!1},be=o=>{E.success(`用户状态已更新为${o.status==="active"?"正常":"禁用"}`)},ve=o=>{w.value={...o},Object.assign(e,{newPassword:"",confirmNewPassword:""}),k.value=!0},ye=()=>{w.value&&(E.success(`用户 ${w.value.username} 密码重置成功`),k.value=!1)},Ve=o=>{if(o.role==="admin"){E.warning("管理员账户不能删除");return}X.confirm(`确定要删除用户「${o.username}」吗？`,"删除用户",{confirmButtonText:"确定",cancelButtonText:"取消",type:"danger"}).then(()=>{const n=_.value.findIndex(b=>b.id===o.id);n!==-1&&(_.value.splice(n,1),E.success("用户删除成功"))}).catch(()=>{})},_e=o=>{w.value={...o},G(o)},he=()=>{E.success("用户数据导出成功")},Ue=o=>{O.value=o},Ce=o=>{L.value=o},Ee=o=>{h.value=o},Pe=o=>{f.value=o},ke=()=>{Z.value=[{id:"a",name:"A栋"},{id:"b",name:"B栋"},{id:"c",name:"C栋"},{id:"d",name:"D栋"},{id:"parking",name:"停车场"}],U.value=[{id:"ENT-001",name:"科技有限公司",industry:"technology",contactPerson:"张三",contactPhone:"13800138001",email:"contact@techcorp.com",address:"智慧园区A栋3层",energyQuota:5e4,monthEnergyUsage:48500,occupiedZones:["a","d"],status:"normal",registeredDate:"2023-01-15T00:00:00.000Z",remark:"园区主要入驻企业"},{id:"ENT-002",name:"智慧园区管理处",industry:"other",contactPerson:"李四",contactPhone:"13900139002",email:"admin@smartpark.com",address:"智慧园区B栋1层",energyQuota:1e4,monthEnergyUsage:8500,occupiedZones:["b"],status:"normal",registeredDate:"2022-12-01T00:00:00.000Z",remark:"园区管理机构"},{id:"ENT-003",name:"绿色能源公司",industry:"technology",contactPerson:"王五",contactPhone:"13700137003",email:"info@greenenergy.com",address:"智慧园区B栋2层",energyQuota:2e4,monthEnergyUsage:18500,occupiedZones:["b"],status:"normal",registeredDate:"2023-03-20T00:00:00.000Z",remark:"新能源技术研发企业"},{id:"ENT-004",name:"物业服务公司",industry:"other",contactPerson:"赵六",contactPhone:"13600136004",email:"service@property.com",address:"智慧园区C栋1层",energyQuota:15e3,monthEnergyUsage:14200,occupiedZones:["c"],status:"normal",registeredDate:"2023-02-10T00:00:00.000Z",remark:"园区物业服务提供商"},{id:"ENT-005",name:"创新设计工作室",industry:"technology",contactPerson:"孙七",contactPhone:"13500135005",email:"design@creative.com",address:"智慧园区D栋3层",energyQuota:8e3,monthEnergyUsage:9500,occupiedZones:["d"],status:"disabled",registeredDate:"2023-04-05T00:00:00.000Z",remark:"设计创意企业，已禁用"}],_.value=[{id:"USR-001",username:"admin",realName:"系统管理员",role:"admin",enterpriseId:"",email:"admin@smartpark.com",phone:"13800138000",status:"active",createdAt:"2022-12-01T00:00:00.000Z"},{id:"USR-002",username:"zhang_san",realName:"张三",role:"enterprise_admin",enterpriseId:"ENT-001",email:"zhangsan@techcorp.com",phone:"13800138001",status:"active",createdAt:"2023-01-15T00:00:00.000Z"},{id:"USR-003",username:"li_si",realName:"李四",role:"enterprise_admin",enterpriseId:"ENT-002",email:"lisi@smartpark.com",phone:"13900139002",status:"active",createdAt:"2022-12-01T00:00:00.000Z"},{id:"USR-004",username:"wang_wu",realName:"王五",role:"maintenance",enterpriseId:"ENT-002",email:"wangwu@smartpark.com",phone:"13700137003",status:"active",createdAt:"2023-01-20T00:00:00.000Z"},{id:"USR-005",username:"zhao_liu",realName:"赵六",role:"maintenance",enterpriseId:"ENT-004",email:"zhaoliu@property.com",phone:"13600136004",status:"active",createdAt:"2023-02-10T00:00:00.000Z"},{id:"USR-006",username:"sun_qi",realName:"孙七",role:"user",enterpriseId:"ENT-001",email:"sunqi@techcorp.com",phone:"13500135005",status:"active",createdAt:"2023-01-16T00:00:00.000Z"},{id:"USR-007",username:"zhou_ba",realName:"周八",role:"user",enterpriseId:"ENT-003",email:"zhouba@greenenergy.com",phone:"13400134006",status:"active",createdAt:"2023-03-22T00:00:00.000Z"},{id:"USR-008",username:"wu_jiu",realName:"吴九",role:"user",enterpriseId:"ENT-005",email:"wujiu@creative.com",phone:"13300133007",status:"inactive",createdAt:"2023-04-05T00:00:00.000Z"}]};return xe(()=>{ke()}),{activeTab:H,enterpriseSearchKeyword:a,enterpriseStatusFilter:B,enterpriseIndustryFilter:r,enterpriseCurrentPage:L,enterprisePageSize:O,userSearchKeyword:x,userRoleFilter:q,userStatusFilter:g,userCurrentPage:f,userPageSize:h,enterpriseDialogVisible:N,enterpriseDetailDialogVisible:T,isEditEnterprise:d,userDialogVisible:z,isEditUser:i,resetPasswordDialogVisible:k,enterprises:U,users:_,zones:Z,selectedEnterprise:A,selectedUser:w,industries:j,enterpriseForm:C,enterpriseFormRules:m,userForm:P,userFormRules:Q,resetPasswordForm:e,resetPasswordFormRules:V,filteredEnterprises:$,filteredUsers:ee,getIndustryName:re,getRoleName:le,getRoleTagType:ae,getEnterpriseName:te,getZoneNames:oe,formatDate:Y,formatDateTime:ne,handleEnterpriseClick:se,handleUserClick:ie,viewEnterpriseDetail:de,openAddEnterpriseDialog:ue,editEnterprise:me,saveEnterprise:pe,toggleEnterpriseStatus:ce,exportEnterpriseData:ge,openAddUserDialog:fe,editUser:G,saveUser:we,handleUserStatusChange:be,resetUserPassword:ve,confirmResetPassword:ye,deleteUser:Ve,viewUserDetail:_e,exportUserData:he,handleEnterpriseSizeChange:Ue,handleEnterpriseCurrentChange:Ce,handleUserSizeChange:Ee,handleUserCurrentChange:Pe}}},ze={class:"enterprise-management"},Ie={class:"page-header"},Re={key:0,class:"tab-content"},Ze={class:"toolbar"},qe={class:"search-section"},Ae={class:"action-section"},Qe={class:"enterprise-name-wrapper"},Be={class:"energy-usage-wrapper"},je={class:"pagination-wrapper"},Me={key:1,class:"tab-content"},Ke={class:"toolbar"},Le={class:"search-section"},Oe={class:"action-section"},We={class:"pagination-wrapper"},He={class:"dialog-footer"},Ye={class:"dialog-footer"},Ge={key:0,class:"el-form-item__help"},Je={class:"dialog-footer"},Xe={class:"dialog-footer"};function $e(H,a,B,r,L,O){const x=p("el-tab-pane"),q=p("el-tabs"),g=p("el-input"),f=p("el-option"),h=p("el-select"),N=p("Plus"),T=p("el-icon"),d=p("el-button"),z=p("Download"),i=p("el-table-column"),k=p("el-tag"),U=p("el-table"),_=p("el-pagination"),Z=p("el-card"),A=p("el-switch"),w=p("el-descriptions-item"),j=p("el-descriptions"),C=p("el-dialog"),m=p("el-form-item"),P=p("el-input-number"),Q=p("el-form");return y(),D("div",ze,[v("div",Ie,[a[38]||(a[38]=v("h1",null,"企业/用户管理",-1)),l(q,{modelValue:r.activeTab,"onUpdate:modelValue":a[0]||(a[0]=e=>r.activeTab=e),class:"header-tabs"},{default:t(()=>[l(x,{label:"企业管理",name:"enterprise"}),l(x,{label:"用户管理",name:"user"})]),_:1},8,["modelValue"])]),r.activeTab==="enterprise"?(y(),D("div",Re,[v("div",Ze,[v("div",qe,[l(g,{modelValue:r.enterpriseSearchKeyword,"onUpdate:modelValue":a[1]||(a[1]=e=>r.enterpriseSearchKeyword=e),placeholder:"搜索企业名称或联系人","prefix-icon":"el-icon-search",clearable:"",style:{width:"240px","margin-right":"15px"}},null,8,["modelValue"]),l(h,{modelValue:r.enterpriseStatusFilter,"onUpdate:modelValue":a[2]||(a[2]=e=>r.enterpriseStatusFilter=e),placeholder:"状态筛选",clearable:"",style:{width:"120px","margin-right":"15px"}},{default:t(()=>[l(f,{label:"正常",value:"normal"}),l(f,{label:"禁用",value:"disabled"})]),_:1},8,["modelValue"]),l(h,{modelValue:r.enterpriseIndustryFilter,"onUpdate:modelValue":a[3]||(a[3]=e=>r.enterpriseIndustryFilter=e),placeholder:"行业筛选",clearable:"",style:{width:"150px"}},{default:t(()=>[(y(!0),D(M,null,K(r.industries,e=>(y(),F(f,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),v("div",Ae,[l(d,{type:"primary",onClick:r.openAddEnterpriseDialog},{default:t(()=>[l(T,null,{default:t(()=>[l(N)]),_:1}),a[39]||(a[39]=s(" 新增企业 ",-1))]),_:1},8,["onClick"]),l(d,{onClick:r.exportEnterpriseData},{default:t(()=>[l(T,null,{default:t(()=>[l(z)]),_:1}),a[40]||(a[40]=s(" 导出数据 ",-1))]),_:1},8,["onClick"])])]),l(Z,null,{default:t(()=>[l(U,{data:r.filteredEnterprises,style:{width:"100%"},border:"",onRowClick:r.handleEnterpriseClick},{default:t(()=>[l(i,{type:"selection",width:"55"}),l(i,{prop:"id",label:"企业ID",width:"100",fixed:""}),l(i,{prop:"name",label:"企业名称",width:"200"},{default:t(e=>[v("div",Qe,[v("span",null,c(e.row.name),1),e.row.status==="disabled"?(y(),F(k,{key:0,type:"danger",size:"small",style:{"margin-left":"5px"}},{default:t(()=>[...a[41]||(a[41]=[s(" 已禁用 ",-1)])]),_:1})):S("",!0)])]),_:1}),l(i,{prop:"industry",label:"所属行业",width:"120"},{default:t(e=>[l(k,{size:"small"},{default:t(()=>[s(c(r.getIndustryName(e.row.industry)),1)]),_:2},1024)]),_:1}),l(i,{prop:"contactPerson",label:"联系人",width:"100"}),l(i,{prop:"contactPhone",label:"联系电话",width:"120"}),l(i,{prop:"energyQuota",label:"能耗配额(kWh/月)",width:"140",align:"right"}),l(i,{prop:"monthEnergyUsage",label:"本月能耗(kWh)",width:"120",align:"right"},{default:t(e=>[v("div",Be,[v("span",{class:Ne({"over-quota":e.row.monthEnergyUsage>e.row.energyQuota})},c(e.row.monthEnergyUsage),3),e.row.monthEnergyUsage>e.row.energyQuota?(y(),F(k,{key:0,type:"danger",size:"small",effect:"dark",style:{"margin-left":"5px"}},{default:t(()=>[...a[42]||(a[42]=[s(" 超配额 ",-1)])]),_:1})):S("",!0)])]),_:1}),l(i,{prop:"registeredDate",label:"注册日期",width:"120",align:"center"},{default:t(e=>[s(c(r.formatDate(e.row.registeredDate)),1)]),_:1}),l(i,{label:"操作",width:"180",fixed:"right"},{default:t(e=>[l(d,{size:"small",type:"primary",onClick:R(V=>r.viewEnterpriseDetail(e.row),["stop"])},{default:t(()=>[...a[43]||(a[43]=[s("详情",-1)])]),_:1},8,["onClick"]),l(d,{size:"small",onClick:R(V=>r.editEnterprise(e.row),["stop"])},{default:t(()=>[...a[44]||(a[44]=[s("编辑",-1)])]),_:1},8,["onClick"]),l(d,{size:"small",type:e.row.status==="normal"?"danger":"success",onClick:R(V=>r.toggleEnterpriseStatus(e.row),["stop"])},{default:t(()=>[s(c(e.row.status==="normal"?"禁用":"启用"),1)]),_:2},1032,["type","onClick"])]),_:1})]),_:1},8,["data","onRowClick"]),v("div",je,[l(_,{"current-page":r.enterpriseCurrentPage,"onUpdate:currentPage":a[4]||(a[4]=e=>r.enterpriseCurrentPage=e),"page-size":r.enterprisePageSize,"onUpdate:pageSize":a[5]||(a[5]=e=>r.enterprisePageSize=e),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:r.filteredEnterprises.length,onSizeChange:r.handleEnterpriseSizeChange,onCurrentChange:r.handleEnterpriseCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])]),_:1})])):S("",!0),r.activeTab==="user"?(y(),D("div",Me,[v("div",Ke,[v("div",Le,[l(g,{modelValue:r.userSearchKeyword,"onUpdate:modelValue":a[6]||(a[6]=e=>r.userSearchKeyword=e),placeholder:"搜索用户名或姓名","prefix-icon":"el-icon-search",clearable:"",style:{width:"240px","margin-right":"15px"}},null,8,["modelValue"]),l(h,{modelValue:r.userRoleFilter,"onUpdate:modelValue":a[7]||(a[7]=e=>r.userRoleFilter=e),placeholder:"角色筛选",clearable:"",style:{width:"120px","margin-right":"15px"}},{default:t(()=>[l(f,{label:"管理员",value:"admin"}),l(f,{label:"企业负责人",value:"enterprise_admin"}),l(f,{label:"运维人员",value:"maintenance"}),l(f,{label:"普通用户",value:"user"})]),_:1},8,["modelValue"]),l(h,{modelValue:r.userStatusFilter,"onUpdate:modelValue":a[8]||(a[8]=e=>r.userStatusFilter=e),placeholder:"状态筛选",clearable:"",style:{width:"120px"}},{default:t(()=>[l(f,{label:"正常",value:"active"}),l(f,{label:"禁用",value:"inactive"})]),_:1},8,["modelValue"])]),v("div",Oe,[l(d,{type:"primary",onClick:r.openAddUserDialog},{default:t(()=>[l(T,null,{default:t(()=>[l(N)]),_:1}),a[45]||(a[45]=s(" 新增用户 ",-1))]),_:1},8,["onClick"]),l(d,{onClick:r.exportUserData},{default:t(()=>[l(T,null,{default:t(()=>[l(z)]),_:1}),a[46]||(a[46]=s(" 导出数据 ",-1))]),_:1},8,["onClick"])])]),l(Z,null,{default:t(()=>[l(U,{data:r.filteredUsers,style:{width:"100%"},border:"",onRowClick:r.handleUserClick},{default:t(()=>[l(i,{type:"selection",width:"55"}),l(i,{prop:"id",label:"用户ID",width:"100",fixed:""}),l(i,{prop:"username",label:"用户名",width:"150"}),l(i,{prop:"realName",label:"真实姓名",width:"120"}),l(i,{prop:"role",label:"角色",width:"120"},{default:t(e=>[l(k,{type:r.getRoleTagType(e.row.role),size:"small"},{default:t(()=>[s(c(r.getRoleName(e.row.role)),1)]),_:2},1032,["type"])]),_:1}),l(i,{prop:"enterpriseId",label:"所属企业",width:"180"},{default:t(e=>[s(c(r.getEnterpriseName(e.row.enterpriseId)||"系统管理"),1)]),_:1}),l(i,{prop:"email",label:"邮箱",width:"180"}),l(i,{prop:"phone",label:"手机号码",width:"120"}),l(i,{prop:"status",label:"状态",width:"100",align:"center"},{default:t(e=>[l(A,{modelValue:e.row.status,"onUpdate:modelValue":V=>e.row.status=V,"active-value":"active","inactive-value":"inactive",onChange:V=>r.handleUserStatusChange(e.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),l(i,{prop:"createdAt",label:"创建时间",width:"140",align:"center"},{default:t(e=>[s(c(r.formatDateTime(e.row.createdAt)),1)]),_:1}),l(i,{label:"操作",width:"220",fixed:"right"},{default:t(e=>[l(d,{size:"small",type:"primary",onClick:R(V=>r.viewUserDetail(e.row),["stop"])},{default:t(()=>[...a[47]||(a[47]=[s("详情",-1)])]),_:1},8,["onClick"]),l(d,{size:"small",onClick:R(V=>r.editUser(e.row),["stop"])},{default:t(()=>[...a[48]||(a[48]=[s("编辑",-1)])]),_:1},8,["onClick"]),l(d,{size:"small",onClick:R(V=>r.resetUserPassword(e.row),["stop"])},{default:t(()=>[...a[49]||(a[49]=[s("重置密码",-1)])]),_:1},8,["onClick"]),l(d,{size:"small",type:"danger",onClick:R(V=>r.deleteUser(e.row),["stop"])},{default:t(()=>[...a[50]||(a[50]=[s("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data","onRowClick"]),v("div",We,[l(_,{"current-page":r.userCurrentPage,"onUpdate:currentPage":a[9]||(a[9]=e=>r.userCurrentPage=e),"page-size":r.userPageSize,"onUpdate:pageSize":a[10]||(a[10]=e=>r.userPageSize=e),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:r.filteredUsers.length,onSizeChange:r.handleUserSizeChange,onCurrentChange:r.handleUserCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])]),_:1})])):S("",!0),l(C,{modelValue:r.enterpriseDetailDialogVisible,"onUpdate:modelValue":a[12]||(a[12]=e=>r.enterpriseDetailDialogVisible=e),title:"企业详情",width:"600px"},{footer:t(()=>[v("span",He,[l(d,{onClick:a[11]||(a[11]=e=>r.enterpriseDetailDialogVisible=!1)},{default:t(()=>[...a[51]||(a[51]=[s("关闭",-1)])]),_:1})])]),default:t(()=>[l(j,{column:1,border:""},{default:t(()=>[l(w,{label:"企业ID"},{default:t(()=>{var e;return[s(c((e=r.selectedEnterprise)==null?void 0:e.id),1)]}),_:1}),l(w,{label:"企业名称"},{default:t(()=>{var e;return[s(c((e=r.selectedEnterprise)==null?void 0:e.name),1)]}),_:1}),l(w,{label:"所属行业"},{default:t(()=>{var e;return[s(c(r.getIndustryName((e=r.selectedEnterprise)==null?void 0:e.industry)),1)]}),_:1}),l(w,{label:"联系人"},{default:t(()=>{var e;return[s(c((e=r.selectedEnterprise)==null?void 0:e.contactPerson),1)]}),_:1}),l(w,{label:"联系电话"},{default:t(()=>{var e;return[s(c((e=r.selectedEnterprise)==null?void 0:e.contactPhone),1)]}),_:1}),l(w,{label:"电子邮箱"},{default:t(()=>{var e;return[s(c((e=r.selectedEnterprise)==null?void 0:e.email),1)]}),_:1}),l(w,{label:"地址"},{default:t(()=>{var e;return[s(c((e=r.selectedEnterprise)==null?void 0:e.address),1)]}),_:1}),l(w,{label:"能耗配额"},{default:t(()=>{var e;return[s(c((e=r.selectedEnterprise)==null?void 0:e.energyQuota)+" kWh/月",1)]}),_:1}),l(w,{label:"本月能耗"},{default:t(()=>{var e;return[s(c((e=r.selectedEnterprise)==null?void 0:e.monthEnergyUsage)+" kWh",1)]}),_:1}),l(w,{label:"占用区域"},{default:t(()=>{var e;return[s(c(r.getZoneNames((e=r.selectedEnterprise)==null?void 0:e.occupiedZones)),1)]}),_:1}),l(w,{label:"注册日期"},{default:t(()=>{var e;return[s(c(r.formatDate((e=r.selectedEnterprise)==null?void 0:e.registeredDate)),1)]}),_:1}),l(w,{label:"状态"},{default:t(()=>{var e;return[l(k,{type:((e=r.selectedEnterprise)==null?void 0:e.status)==="normal"?"success":"danger"},{default:t(()=>{var V;return[s(c(((V=r.selectedEnterprise)==null?void 0:V.status)==="normal"?"正常":"禁用"),1)]}),_:1},8,["type"])]}),_:1}),l(w,{label:"备注"},{default:t(()=>{var e;return[s(c(((e=r.selectedEnterprise)==null?void 0:e.remark)||"--"),1)]}),_:1})]),_:1})]),_:1},8,["modelValue"]),l(C,{modelValue:r.enterpriseDialogVisible,"onUpdate:modelValue":a[23]||(a[23]=e=>r.enterpriseDialogVisible=e),title:r.isEditEnterprise?"编辑企业":"新增企业",width:"600px"},{footer:t(()=>[v("span",Ye,[l(d,{onClick:a[22]||(a[22]=e=>r.enterpriseDialogVisible=!1)},{default:t(()=>[...a[52]||(a[52]=[s("取消",-1)])]),_:1}),l(d,{type:"primary",onClick:r.saveEnterprise},{default:t(()=>[...a[53]||(a[53]=[s("确定",-1)])]),_:1},8,["onClick"])])]),default:t(()=>[l(Q,{ref:"enterpriseForm",model:r.enterpriseForm,"label-width":"120px",rules:r.enterpriseFormRules},{default:t(()=>[l(m,{label:"企业名称",prop:"name"},{default:t(()=>[l(g,{modelValue:r.enterpriseForm.name,"onUpdate:modelValue":a[13]||(a[13]=e=>r.enterpriseForm.name=e),placeholder:"请输入企业名称"},null,8,["modelValue"])]),_:1}),l(m,{label:"所属行业",prop:"industry"},{default:t(()=>[l(h,{modelValue:r.enterpriseForm.industry,"onUpdate:modelValue":a[14]||(a[14]=e=>r.enterpriseForm.industry=e),placeholder:"请选择所属行业"},{default:t(()=>[(y(!0),D(M,null,K(r.industries,e=>(y(),F(f,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"联系人",prop:"contactPerson"},{default:t(()=>[l(g,{modelValue:r.enterpriseForm.contactPerson,"onUpdate:modelValue":a[15]||(a[15]=e=>r.enterpriseForm.contactPerson=e),placeholder:"请输入联系人姓名"},null,8,["modelValue"])]),_:1}),l(m,{label:"联系电话",prop:"contactPhone"},{default:t(()=>[l(g,{modelValue:r.enterpriseForm.contactPhone,"onUpdate:modelValue":a[16]||(a[16]=e=>r.enterpriseForm.contactPhone=e),placeholder:"请输入联系电话"},null,8,["modelValue"])]),_:1}),l(m,{label:"电子邮箱",prop:"email"},{default:t(()=>[l(g,{modelValue:r.enterpriseForm.email,"onUpdate:modelValue":a[17]||(a[17]=e=>r.enterpriseForm.email=e),placeholder:"请输入电子邮箱",type:"email"},null,8,["modelValue"])]),_:1}),l(m,{label:"地址",prop:"address"},{default:t(()=>[l(g,{modelValue:r.enterpriseForm.address,"onUpdate:modelValue":a[18]||(a[18]=e=>r.enterpriseForm.address=e),placeholder:"请输入企业地址",type:"textarea",rows:2},null,8,["modelValue"])]),_:1}),l(m,{label:"能耗配额(kWh/月)",prop:"energyQuota"},{default:t(()=>[l(P,{modelValue:r.enterpriseForm.energyQuota,"onUpdate:modelValue":a[19]||(a[19]=e=>r.enterpriseForm.energyQuota=e),min:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(m,{label:"占用区域",prop:"occupiedZones"},{default:t(()=>[l(h,{modelValue:r.enterpriseForm.occupiedZones,"onUpdate:modelValue":a[20]||(a[20]=e=>r.enterpriseForm.occupiedZones=e),placeholder:"请选择占用区域",multiple:"","collapse-tags":""},{default:t(()=>[(y(!0),D(M,null,K(r.zones,e=>(y(),F(f,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"备注"},{default:t(()=>[l(g,{modelValue:r.enterpriseForm.remark,"onUpdate:modelValue":a[21]||(a[21]=e=>r.enterpriseForm.remark=e),placeholder:"请输入备注信息",type:"textarea",rows:3},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),l(C,{modelValue:r.userDialogVisible,"onUpdate:modelValue":a[33]||(a[33]=e=>r.userDialogVisible=e),title:r.isEditUser?"编辑用户":"新增用户",width:"600px"},{footer:t(()=>[v("span",Je,[l(d,{onClick:a[32]||(a[32]=e=>r.userDialogVisible=!1)},{default:t(()=>[...a[54]||(a[54]=[s("取消",-1)])]),_:1}),l(d,{type:"primary",onClick:r.saveUser},{default:t(()=>[...a[55]||(a[55]=[s("确定",-1)])]),_:1},8,["onClick"])])]),default:t(()=>[l(Q,{ref:"userForm",model:r.userForm,"label-width":"120px",rules:r.userFormRules},{default:t(()=>[l(m,{label:"用户名",prop:"username"},{default:t(()=>[l(g,{modelValue:r.userForm.username,"onUpdate:modelValue":a[24]||(a[24]=e=>r.userForm.username=e),disabled:r.isEditUser,placeholder:"请输入用户名"},null,8,["modelValue","disabled"]),r.isEditUser?(y(),D("div",Ge,"用户名不可修改")):S("",!0)]),_:1}),r.isEditUser?S("",!0):(y(),F(m,{key:0,label:"密码",prop:"password"},{default:t(()=>[l(g,{modelValue:r.userForm.password,"onUpdate:modelValue":a[25]||(a[25]=e=>r.userForm.password=e),type:"password",placeholder:"请输入密码"},null,8,["modelValue"])]),_:1})),r.isEditUser?S("",!0):(y(),F(m,{key:1,label:"确认密码",prop:"confirmPassword"},{default:t(()=>[l(g,{modelValue:r.userForm.confirmPassword,"onUpdate:modelValue":a[26]||(a[26]=e=>r.userForm.confirmPassword=e),type:"password",placeholder:"请再次输入密码"},null,8,["modelValue"])]),_:1})),l(m,{label:"真实姓名",prop:"realName"},{default:t(()=>[l(g,{modelValue:r.userForm.realName,"onUpdate:modelValue":a[27]||(a[27]=e=>r.userForm.realName=e),placeholder:"请输入真实姓名"},null,8,["modelValue"])]),_:1}),l(m,{label:"角色",prop:"role"},{default:t(()=>[l(h,{modelValue:r.userForm.role,"onUpdate:modelValue":a[28]||(a[28]=e=>r.userForm.role=e),placeholder:"请选择角色"},{default:t(()=>[l(f,{label:"管理员",value:"admin"}),l(f,{label:"企业负责人",value:"enterprise_admin"}),l(f,{label:"运维人员",value:"maintenance"}),l(f,{label:"普通用户",value:"user"})]),_:1},8,["modelValue"])]),_:1}),r.userForm.role!=="admin"?(y(),F(m,{key:2,label:"所属企业",prop:"enterpriseId"},{default:t(()=>[l(h,{modelValue:r.userForm.enterpriseId,"onUpdate:modelValue":a[29]||(a[29]=e=>r.userForm.enterpriseId=e),placeholder:"请选择所属企业"},{default:t(()=>[l(f,{label:"请选择企业",value:"",disabled:""}),(y(!0),D(M,null,K(r.enterprises,e=>(y(),F(f,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):S("",!0),l(m,{label:"邮箱",prop:"email"},{default:t(()=>[l(g,{modelValue:r.userForm.email,"onUpdate:modelValue":a[30]||(a[30]=e=>r.userForm.email=e),placeholder:"请输入邮箱",type:"email"},null,8,["modelValue"])]),_:1}),l(m,{label:"手机号码",prop:"phone"},{default:t(()=>[l(g,{modelValue:r.userForm.phone,"onUpdate:modelValue":a[31]||(a[31]=e=>r.userForm.phone=e),placeholder:"请输入手机号码"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),l(C,{modelValue:r.resetPasswordDialogVisible,"onUpdate:modelValue":a[37]||(a[37]=e=>r.resetPasswordDialogVisible=e),title:"重置密码",width:"400px"},{footer:t(()=>[v("span",Xe,[l(d,{onClick:a[36]||(a[36]=e=>r.resetPasswordDialogVisible=!1)},{default:t(()=>[...a[56]||(a[56]=[s("取消",-1)])]),_:1}),l(d,{type:"primary",onClick:r.confirmResetPassword},{default:t(()=>[...a[57]||(a[57]=[s("确定重置",-1)])]),_:1},8,["onClick"])])]),default:t(()=>[l(Q,{ref:"resetPasswordForm",model:r.resetPasswordForm,"label-width":"100px",rules:r.resetPasswordFormRules},{default:t(()=>[l(m,{label:"新密码",prop:"newPassword"},{default:t(()=>[l(g,{modelValue:r.resetPasswordForm.newPassword,"onUpdate:modelValue":a[34]||(a[34]=e=>r.resetPasswordForm.newPassword=e),type:"password",placeholder:"请输入新密码"},null,8,["modelValue"])]),_:1}),l(m,{label:"确认密码",prop:"confirmNewPassword"},{default:t(()=>[l(g,{modelValue:r.resetPasswordForm.confirmNewPassword,"onUpdate:modelValue":a[35]||(a[35]=e=>r.resetPasswordForm.confirmNewPassword=e),type:"password",placeholder:"请再次输入新密码"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}const rr=Fe(Te,[["render",$e],["__scopeId","data-v-72c7347a"]]);export{rr as default};
