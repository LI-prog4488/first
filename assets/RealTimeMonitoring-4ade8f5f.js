import{_ as X,I as Y,z as $,y as ee,J as ae,G as te,e as ne,r as S,f as j,K as se,L as O,k as oe,M as ie,l as le,g as c,o as d,c as k,a,h as n,i as s,j as _,t as i,n as p,p as y,N as z,F as q,q as H}from"./index-45cd1a9a.js";import{i as re,L as ce}from"./index-6433f102.js";const de={name:"RealTimeMonitoring",components:{Refresh:Y,ArrowDown:$,ArrowUp:ee,Minus:ae,Cpu:te},setup(){const K=ne(),t=S("electricity"),F=S("all"),e=S("5min"),L=S(null);let u=null,C=null;const r=j({electricity:{currentValue:1250,change:5.2,dailyUsage:8250,dailyLimit:12e3,dailyUsagePercentage:68.75},water:{currentValue:8.6,change:-2.1,dailyUsage:185,dailyLimit:240,dailyUsagePercentage:77.08},gas:{currentValue:4.2,change:3.7,dailyUsage:92,dailyLimit:120,dailyUsagePercentage:76.67},heat:{currentValue:1.58,change:.8,dailyUsage:32,dailyLimit:45,dailyUsagePercentage:71.11}}),U=j([{id:"a",name:"A栋",electricity:420,water:3.2,gas:1.5,heat:.6,trend:2.1},{id:"b",name:"B栋",electricity:380,water:2.8,gas:1.3,heat:.5,trend:-1.2},{id:"c",name:"C栋",electricity:290,water:2.1,gas:.9,heat:.4,trend:3.5},{id:"d",name:"D栋",electricity:160,water:.5,gas:.5,heat:.08,trend:0},{id:"parking",name:"停车场",electricity:150,water:0,gas:0,heat:0,trend:1.8}]),h=j([{id:"meter-001",name:"总电表",location:"配电房",status:"online"},{id:"meter-002",name:"A栋电表",location:"A栋1楼",status:"online"},{id:"meter-003",name:"B栋电表",location:"B栋1楼",status:"fault"},{id:"water-001",name:"总水表",location:"水泵房",status:"online"},{id:"gas-001",name:"燃气表",location:"C栋地下室",status:"offline"}]),D=se(()=>{const l=E(t.value);return U.slice().sort((g,m)=>m[l]-g[l]).map((g,m)=>({...g,rank:m+1}))}),V=l=>({electricity:"电力",water:"水",gas:"燃气",heat:"热力"})[l]||l,E=l=>l,v=l=>({electricity:"kW",water:"m³/h",gas:"m³/h",heat:"GJ/h"})[l]||"",w=l=>l>=90?"#F56C6C":l>=70?"#E6A23C":"#67C23A",b=l=>({online:"success",offline:"info",fault:"danger"})[l]||"warning",G=l=>({online:"在线",offline:"离线",fault:"故障"})[l]||"未知",P=l=>{e.value=l,f()},B=()=>{f()},M=()=>{K.push("/device-management")},N=()=>{L.value&&(u=re(L.value),f())},f=()=>{if(!u)return;const l=Z(),g=[],m=new Date,A=I();for(let T=l-1;T>=0;T--){const x=new Date(m-T*A*60*1e3);g.push(`${x.getHours().toString().padStart(2,"0")}:${x.getMinutes().toString().padStart(2,"0")}`)}const R=o(l),W={electricity:"#36cfc9",water:"#409EFF",gas:"#E6A23C",heat:"#F56C6C"},Q={tooltip:{trigger:"axis",formatter:T=>{const x=T[0];return`${x.axisValue}<br/>${V(t.value)}: ${x.value} ${v(t.value)}`}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:g},yAxis:{type:"value"},series:[{name:V(t.value),type:"line",data:R,smooth:!0,symbol:"circle",symbolSize:6,lineStyle:{color:W[t.value],width:3},itemStyle:{color:W[t.value],borderWidth:2,borderColor:"#fff"},areaStyle:{color:new ce(0,0,0,1,[{offset:0,color:W[t.value]},{offset:1,color:"rgba(255, 255, 255, 0.1)"}])}}]};u.setOption(Q)},Z=()=>({"5min":12,"15min":16,"30min":16,"1hour":12})[e.value]||12,I=()=>({"5min":5,"15min":15,"30min":30,"1hour":60})[e.value]||5,o=l=>{const g=r[t.value].currentValue,m=g*.1,A=[];for(let R=0;R<l;R++)A.push(g+(Math.random()-.5)*m);return A},J=()=>{u&&u.resize()};return O(t,()=>{f()}),O(F,()=>{f()}),oe(async()=>{await ie(),N(),window.addEventListener("resize",J),C=setInterval(()=>{const l=t.value,g=r[l],m=(Math.random()-.5)*g.currentValue*.05;g.currentValue=Math.max(0,g.currentValue+m),f()},1e4)}),le(()=>{u&&u.dispose(),C&&clearInterval(C),window.removeEventListener("resize",J)}),{activeEnergyTab:t,selectedZone:F,energyTrendChartRef:L,energyData:r,zones:U,sortedZones:D,keyDevices:h,getEnergyName:V,getEnergyField:E,getEnergyUnit:v,getProgressColor:w,getStatusType:b,getStatusText:G,handleDataRange:P,refreshData:B,navigateToDeviceManagement:M}}},ge={class:"real-time-monitoring"},_e={class:"page-header"},ye={class:"header-actions"},me={class:"energy-type-selector"},ue={class:"energy-type-content"},he={class:"current-data"},ve={class:"data-value"},fe={class:"data-info"},pe={class:"data-limit"},De={class:"limit-label"},we={class:"progress-container"},be={class:"usage-text"},ke={class:"energy-type-content"},Ce={class:"current-data"},Ue={class:"data-value"},Ve={class:"data-info"},Me={class:"data-limit"},Te={class:"limit-label"},xe={class:"progress-container"},Le={class:"usage-text"},Ee={class:"energy-type-content"},Pe={class:"current-data"},Ae={class:"data-value"},Re={class:"data-info"},Se={class:"data-limit"},ze={class:"limit-label"},Fe={class:"progress-container"},Ge={class:"usage-text"},Be={class:"energy-type-content"},Ne={class:"current-data"},Ze={class:"data-value"},Ie={class:"data-info"},Je={class:"data-limit"},We={class:"limit-label"},je={class:"progress-container"},qe={class:"usage-text"},He={class:"monitoring-content"},Ke={class:"chart-section"},Oe={class:"card-header"},Qe={id:"energyTrendChart",ref:"energyTrendChartRef",class:"chart"},Xe={class:"zone-section"},Ye={class:"zone-list"},$e=["onClick"],ea={class:"zone-rank"},aa={class:"zone-info"},ta={class:"zone-name"},na={class:"zone-value"},sa={class:"card-header"},oa={class:"device-status-list"},ia={class:"device-icon"},la={class:"device-info"},ra={class:"device-name"},ca={class:"device-location"},da={class:"device-status-badge"};function ga(K,t,F,e,L,u){const C=c("Refresh"),r=c("el-icon"),U=c("el-button"),h=c("ArrowDown"),D=c("el-dropdown-item"),V=c("el-dropdown-menu"),E=c("el-dropdown"),v=c("ArrowUp"),w=c("el-progress"),b=c("el-tab-pane"),G=c("el-tabs"),P=c("el-option"),B=c("el-select"),M=c("el-card"),N=c("Minus"),f=c("el-link"),Z=c("Cpu"),I=c("el-tag");return d(),k("div",ge,[a("div",_e,[t[8]||(t[8]=a("h1",null,"实时能耗监控",-1)),a("div",ye,[n(U,{type:"primary",size:"small",onClick:e.refreshData},{default:s(()=>[n(r,null,{default:s(()=>[n(C)]),_:1}),t[2]||(t[2]=_(" 刷新数据 ",-1))]),_:1},8,["onClick"]),n(E,{onCommand:e.handleDataRange},{dropdown:s(()=>[n(V,null,{default:s(()=>[n(D,{command:"5min"},{default:s(()=>[...t[4]||(t[4]=[_("5分钟",-1)])]),_:1}),n(D,{command:"15min"},{default:s(()=>[...t[5]||(t[5]=[_("15分钟",-1)])]),_:1}),n(D,{command:"30min"},{default:s(()=>[...t[6]||(t[6]=[_("30分钟",-1)])]),_:1}),n(D,{command:"1hour"},{default:s(()=>[...t[7]||(t[7]=[_("1小时",-1)])]),_:1})]),_:1})]),default:s(()=>[n(U,{type:"default",size:"small"},{default:s(()=>[t[3]||(t[3]=_(" 数据显示周期 ",-1)),n(r,{class:"el-icon--right"},{default:s(()=>[n(h)]),_:1})]),_:1})]),_:1},8,["onCommand"])])]),a("div",me,[n(G,{modelValue:e.activeEnergyTab,"onUpdate:modelValue":t[0]||(t[0]=o=>e.activeEnergyTab=o),type:"card"},{default:s(()=>[n(b,{label:"电力",name:"electricity"},{default:s(()=>[a("div",ue,[a("div",he,[a("div",ve,i(e.energyData.electricity.currentValue)+" kW",1),a("div",fe,[t[9]||(t[9]=a("span",{class:"data-label"},"当前功率",-1)),a("span",{class:p(["data-change",{positive:e.energyData.electricity.change>0,negative:e.energyData.electricity.change<0}])},[e.energyData.electricity.change>0?(d(),y(r,{key:0},{default:s(()=>[n(v)]),_:1})):e.energyData.electricity.change<0?(d(),y(r,{key:1},{default:s(()=>[n(h)]),_:1})):z("",!0),_(" "+i(Math.abs(e.energyData.electricity.change))+"% ",1)],2)])]),a("div",pe,[a("div",De,"今日限额："+i(e.energyData.electricity.dailyLimit)+" kWh",1),a("div",we,[n(w,{percentage:e.energyData.electricity.dailyUsagePercentage,color:e.getProgressColor(e.energyData.electricity.dailyUsagePercentage)},null,8,["percentage","color"]),a("span",be,i(e.energyData.electricity.dailyUsage)+" kWh / "+i(e.energyData.electricity.dailyLimit)+" kWh",1)])])])]),_:1}),n(b,{label:"水",name:"water"},{default:s(()=>[a("div",ke,[a("div",Ce,[a("div",Ue,i(e.energyData.water.currentValue)+" m³/h",1),a("div",Ve,[t[10]||(t[10]=a("span",{class:"data-label"},"当前流量",-1)),a("span",{class:p(["data-change",{positive:e.energyData.water.change>0,negative:e.energyData.water.change<0}])},[e.energyData.water.change>0?(d(),y(r,{key:0},{default:s(()=>[n(v)]),_:1})):e.energyData.water.change<0?(d(),y(r,{key:1},{default:s(()=>[n(h)]),_:1})):z("",!0),_(" "+i(Math.abs(e.energyData.water.change))+"% ",1)],2)])]),a("div",Me,[a("div",Te,"今日限额："+i(e.energyData.water.dailyLimit)+" m³",1),a("div",xe,[n(w,{percentage:e.energyData.water.dailyUsagePercentage,color:e.getProgressColor(e.energyData.water.dailyUsagePercentage)},null,8,["percentage","color"]),a("span",Le,i(e.energyData.water.dailyUsage)+" m³ / "+i(e.energyData.water.dailyLimit)+" m³",1)])])])]),_:1}),n(b,{label:"燃气",name:"gas"},{default:s(()=>[a("div",Ee,[a("div",Pe,[a("div",Ae,i(e.energyData.gas.currentValue)+" m³/h",1),a("div",Re,[t[11]||(t[11]=a("span",{class:"data-label"},"当前流量",-1)),a("span",{class:p(["data-change",{positive:e.energyData.gas.change>0,negative:e.energyData.gas.change<0}])},[e.energyData.gas.change>0?(d(),y(r,{key:0},{default:s(()=>[n(v)]),_:1})):e.energyData.gas.change<0?(d(),y(r,{key:1},{default:s(()=>[n(h)]),_:1})):z("",!0),_(" "+i(Math.abs(e.energyData.gas.change))+"% ",1)],2)])]),a("div",Se,[a("div",ze,"今日限额："+i(e.energyData.gas.dailyLimit)+" m³",1),a("div",Fe,[n(w,{percentage:e.energyData.gas.dailyUsagePercentage,color:e.getProgressColor(e.energyData.gas.dailyUsagePercentage)},null,8,["percentage","color"]),a("span",Ge,i(e.energyData.gas.dailyUsage)+" m³ / "+i(e.energyData.gas.dailyLimit)+" m³",1)])])])]),_:1}),n(b,{label:"热力",name:"heat"},{default:s(()=>[a("div",Be,[a("div",Ne,[a("div",Ze,i(e.energyData.heat.currentValue)+" GJ/h",1),a("div",Ie,[t[12]||(t[12]=a("span",{class:"data-label"},"当前流量",-1)),a("span",{class:p(["data-change",{positive:e.energyData.heat.change>0,negative:e.energyData.heat.change<0}])},[e.energyData.heat.change>0?(d(),y(r,{key:0},{default:s(()=>[n(v)]),_:1})):e.energyData.heat.change<0?(d(),y(r,{key:1},{default:s(()=>[n(h)]),_:1})):z("",!0),_(" "+i(Math.abs(e.energyData.heat.change))+"% ",1)],2)])]),a("div",Je,[a("div",We,"今日限额："+i(e.energyData.heat.dailyLimit)+" GJ",1),a("div",je,[n(w,{percentage:e.energyData.heat.dailyUsagePercentage,color:e.getProgressColor(e.energyData.heat.dailyUsagePercentage)},null,8,["percentage","color"]),a("span",qe,i(e.energyData.heat.dailyUsage)+" GJ / "+i(e.energyData.heat.dailyLimit)+" GJ",1)])])])]),_:1})]),_:1},8,["modelValue"])]),a("div",He,[a("div",Ke,[n(M,null,{header:s(()=>[a("div",Oe,[a("span",null,i(e.getEnergyName(e.activeEnergyTab))+"监控趋势",1),n(B,{modelValue:e.selectedZone,"onUpdate:modelValue":t[1]||(t[1]=o=>e.selectedZone=o),placeholder:"选择区域",size:"small"},{default:s(()=>[n(P,{label:"全部区域",value:"all"}),(d(!0),k(q,null,H(e.zones,o=>(d(),y(P,{key:o.id,label:o.name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),default:s(()=>[a("div",Qe,null,512)]),_:1})]),a("div",Xe,[n(M,{class:"zone-list-card"},{header:s(()=>[...t[13]||(t[13]=[a("div",{class:"card-header"},[a("span",null,"区域能耗排名")],-1)])]),default:s(()=>[a("div",Ye,[(d(!0),k(q,null,H(e.sortedZones,o=>(d(),k("div",{key:o.id,class:p(["zone-item",{active:e.selectedZone===o.id}]),onClick:J=>e.selectedZone=o.id},[a("div",ea,i(o.rank),1),a("div",aa,[a("div",ta,i(o.name),1),a("div",na,i(o[e.getEnergyField(e.activeEnergyTab)])+" "+i(e.getEnergyUnit(e.activeEnergyTab)),1)]),a("div",{class:p(["zone-trend",{positive:o.trend>0,negative:o.trend<0}])},[o.trend>0?(d(),y(r,{key:0},{default:s(()=>[n(v)]),_:1})):o.trend<0?(d(),y(r,{key:1},{default:s(()=>[n(h)]),_:1})):(d(),y(r,{key:2},{default:s(()=>[n(N)]),_:1})),_(" "+i(Math.abs(o.trend))+"% ",1)],2)],10,$e))),128))])]),_:1}),n(M,{class:"device-status-card"},{header:s(()=>[a("div",sa,[t[15]||(t[15]=a("span",null,"关键设备状态",-1)),n(f,{type:"primary",underline:!1,size:"small",onClick:e.navigateToDeviceManagement},{default:s(()=>[...t[14]||(t[14]=[_(" 查看全部 ",-1)])]),_:1},8,["onClick"])])]),default:s(()=>[a("div",oa,[(d(!0),k(q,null,H(e.keyDevices,o=>(d(),k("div",{key:o.id,class:p(["device-item",{"device-online":o.status==="online","device-offline":o.status==="offline","device-fault":o.status==="fault"}])},[a("div",ia,[n(r,null,{default:s(()=>[n(Z)]),_:1})]),a("div",la,[a("div",ra,i(o.name),1),a("div",ca,i(o.location),1)]),a("div",da,[n(I,{type:e.getStatusType(o.status)},{default:s(()=>[_(i(e.getStatusText(o.status)),1)]),_:2},1032,["type"])])],2))),128))])]),_:1})])])])}const ma=X(de,[["render",ga],["__scopeId","data-v-75f7281e"]]);export{ma as default};
